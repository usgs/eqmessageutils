<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QuakemlPublicId.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">eqmessageutils</a> &gt; <a href="index.source.html" class="el_package">gov.usgs.earthquake.quakeml</a> &gt; <span class="el_source">QuakemlPublicId.java</span></div><h1>QuakemlPublicId.java</h1><pre class="source lang-java linenums">package gov.usgs.earthquake.quakeml;

/**
 * Utility for generating Quakeml Public Ids.
 * 
 * This mapping is used when converting EQXML or CUBE into Quakeml, and can
 * parse IDs generated by this class. However, ANSS networks do not necesarily
 * follow this convention when natively producing quakeml and so it should be
 * used cautiously.
 * 
 * @author jmfee
 */
public class QuakemlPublicId {

	public static final String ANSS_AUTHORITY_PREFIX = &quot;quakeml:&quot;;
	public static final String ANSS_AUTHORITY_SUFFIX = &quot;.anss.org&quot;;

	/** quakeml components. */
	private String authority;
	private String resourceId;

	/** anss components. */
	private String anssDataSource;
	private String anssEventId;
	private String anssResourceType;
	private String anssExtension;

	/**
	 * Construct a quakeml public id using authority and resource id.
	 * 
	 * @param authority
	 *            the quakeml authority.
	 * @param resourceId
	 *            the quakeml resource id.
	 */
<span class="fc" id="L36">	public QuakemlPublicId(final String authority, final String resourceId) {</span>
<span class="fc" id="L37">		this.authority = authority;</span>
<span class="fc" id="L38">		this.resourceId = resourceId;</span>

<span class="fc bfc" id="L40" title="All 2 branches covered.">		if (this.authority.endsWith(ANSS_AUTHORITY_SUFFIX)) {</span>
			// parse the anss data source
<span class="fc" id="L42">			anssDataSource = this.authority;</span>
<span class="fc" id="L43">			anssDataSource = anssDataSource.replace(ANSS_AUTHORITY_PREFIX, &quot;&quot;);</span>
<span class="fc" id="L44">			anssDataSource = anssDataSource.replace(ANSS_AUTHORITY_SUFFIX, &quot;&quot;);</span>
			// parse the resource id
<span class="fc" id="L46">			String[] parts = this.resourceId.split(&quot;/&quot;, 3);</span>
<span class="fc" id="L47">			anssResourceType = parts[0];</span>
<span class="fc" id="L48">			anssEventId = parts[1];</span>
<span class="fc bfc" id="L49" title="All 2 branches covered.">			if (parts.length &gt; 2) {</span>
<span class="fc" id="L50">				anssExtension = parts[2];</span>
			} else {
<span class="fc" id="L52">				anssExtension = null;</span>
			}
		}
<span class="fc" id="L55">	}</span>

	/**
	 * Construct a quakeml public id using anss attributes.
	 * 
	 * @param anssDataSource
	 *            the anss data source.
	 * @param anssEventId
	 *            the anss event id.
	 * @param anssResourceType
	 *            the anss resource type.
	 * @param anssExtension
	 *            any anss extended id for this resource.
	 */
	public QuakemlPublicId(final String anssDataSource,
			final String anssResourceType, final String anssEventId,
<span class="fc" id="L71">			final String anssExtension) {</span>
<span class="fc" id="L72">		this.anssDataSource = anssDataSource;</span>
<span class="fc" id="L73">		this.anssResourceType = anssResourceType;</span>
<span class="fc" id="L74">		this.anssEventId = anssEventId;</span>
<span class="fc" id="L75">		this.anssExtension = anssExtension;</span>

<span class="fc" id="L77">		this.authority = ANSS_AUTHORITY_PREFIX + anssDataSource</span>
				+ ANSS_AUTHORITY_SUFFIX;
<span class="fc" id="L79">		this.resourceId = this.anssResourceType + &quot;/&quot; + this.anssEventId;</span>
<span class="fc bfc" id="L80" title="All 2 branches covered.">		if (this.anssExtension != null) {</span>
<span class="fc" id="L81">			this.resourceId = this.resourceId + &quot;/&quot; + this.anssExtension;</span>
		}
<span class="fc" id="L83">	}</span>

	/**
	 * Whether the quakeml authority for this object matches the ANSS
	 * convention.
	 * 
	 * @return true if this authority appears to be from an ANSS source, false
	 *         otherwise.
	 */
	public boolean isAnss() {
<span class="nc bnc" id="L93" title="All 2 branches missed.">		return this.anssDataSource != null;</span>
	}

	/**
	 * Quakeml public id always has an authority.
	 * 
	 * @return the quakeml authority.
	 */
	public String getAuthority() {
<span class="fc" id="L102">		return this.authority;</span>
	}

	/**
	 * Quakeml public id always has a resource id.
	 * 
	 * @return the quakeml resource id.
	 */
	public String getResourceId() {
<span class="fc" id="L111">		return this.resourceId;</span>
	}

	/**
	 * Only ANSS public ids have an ANSS data source.
	 * 
	 * @return the ANSS data source, or null.
	 */
	public String getAnssDataSource() {
<span class="fc" id="L120">		return this.anssDataSource;</span>
	}

	/**
	 * Only ANSS public ids have an ANSS resource type.
	 * 
	 * @return the ANSS resource type, or null.
	 */
	public String getAnssResourceType() {
<span class="fc" id="L129">		return this.anssResourceType;</span>
	}

	/**
	 * Only ANSS public ids have an ANSS event id.
	 * 
	 * @return the ANSS event id, or null.
	 */
	public String getAnssEventId() {
<span class="fc" id="L138">		return this.anssEventId;</span>
	}

	/**
	 * Only ANSS public ids have an ANSS extension, although it is optional and
	 * may be null.
	 * 
	 * @return the ANSS extension, or null.
	 */
	public String getAnssExtension() {
<span class="fc" id="L148">		return this.anssExtension;</span>
	}

	/**
	 * @return quakeml public id URI.
	 */
	public String getPublicId() {
<span class="fc" id="L155">		return this.authority + &quot;/&quot; + this.resourceId;</span>
	}

	@Override
	public String toString() {
<span class="nc" id="L160">		return this.getPublicId();</span>
	}

	/**
	 * Factory method for public id URI.
	 * 
	 * @param publicId
	 *            the URI to parse.
	 * @return QuakemlPublicId object for URI.
	 */
	public static QuakemlPublicId parse(final String publicId) {
<span class="fc" id="L171">		String[] parts = publicId.split(&quot;/&quot;, 2);</span>
<span class="fc" id="L172">		return new QuakemlPublicId(parts[0], parts[1]);</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>